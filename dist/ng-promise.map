{"version":3,"sources":["ng-promise.map","ng-promise.map*","ng-promise.map**","ng-promise.map***","ng-promise.map****","ng-promise.map*****","ng-promise.map******","ng-promise.map*******"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+B;;;;;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6B;;;;;;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+B;;;;;;ACvEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6B;;;;;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6B;;;;;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4B;;;;;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6B","file":"ng-promise.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 998e088a67446ffe5514\n **/","const MODULE_NAME = 'ngPromise';\n\nimport ngPromise from './src/ng-promise';\nimport ngPending from './src/ng-pending';\nimport ngResolve from './src/ng-resolve';\nimport ngReject from './src/ng-reject';\nimport ngFinally from './src/ng-finally';\n\nangular.module(MODULE_NAME, [])\n  .directive('ngPromise', ngPromise)\n  .directive('ngPending', ngPending)\n  .directive('ngResolve', ngResolve)\n  .directive('ngReject', ngReject)\n  .directive('ngFinally', ngFinally);\n\nexport default MODULE_NAME;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./index.js\n ** module id = 1\n ** module chunks = 0\n **/","/**\n *\n */\n\nimport {isPromise, renderDOM} from './common';\n\nlet ngPromise = ($animate, $parse, $timeout, $window)=> {\n  return {\n    multiElement: true,\n    transclude: 'element',\n    priority: 999,\n    terminal: true,\n    restrict: 'A',\n    controller(){\n    },\n    link($scope, $element, $attr, $ctrl, $transclude){\n      let $promise = $parse($attr.ngPromise)($scope);\n      let ops = {\n        $scope,\n        $element,\n        $attr,\n        $transclude,\n        $animate,\n        $window,\n        $parse,\n        block: null,\n        childScope: null,\n        directive: 'ngPromise'\n      };\n      let loadPromise = (promise)=> {\n        if (isPromise(promise)) {\n          // init data\n          let state = -1;\n          $scope.$broadcast('ngPromise', state);\n          promise\n            .then(()=> {\n              state = 1;\n            }, ()=> {\n              state = 0;\n            })\n            .finally(function () {\n              if (state === -1) {\n                state = !promise.$$state ? 0 : promise.$$state.status === 1 ? 1 : 0;\n              }\n              $scope.$broadcast('ngPromise', state);\n            });\n        }\n      };\n\n      let init = ()=> {\n        renderDOM(ops);\n        loadPromise($promise);\n      };\n\n      /**\n       * 监听promise的变化\n       * 如果有新的promise覆盖旧的promise\n       * 则重新运行指令，根据新的promise，重新渲染视图\n       */\n      var promiseWatcher;\n      let promiseWatchFn = function () {\n        promiseWatcher = $scope.$watch($attr.ngPromise, function (newPromise, oldPromise) {\n          if (newPromise === oldPromise || !newPromise) return;\n          if (isPromise(newPromise)) {\n            loadPromise(newPromise);\n          }\n        });\n      };\n\n      $timeout(()=> {\n        init();\n        promiseWatchFn();\n      });\n\n      $scope.$on('$destroy', function () {\n        promiseWatcher && angular.isFunction(promiseWatcher) && promiseWatcher();\n      });\n\n    }\n  }\n};\n\nngPromise.$inject = ['$animate', '$parse', '$timeout', '$window'];\n\nexport default ngPromise;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/ng-promise.js\n ** module id = 2\n ** module chunks = 0\n **/","/**\n * Created by axetroy on 16-5-14.\n */\n\nconst jqLite = angular.element || window.$ || window.jQuery;\n\nconst isPromise = function (p, undefined) {\n  return p === undefined || !p ? false : !!(angular.isDefined(p) && p.then && angular.isFunction(p.then));\n};\n\nconst stopEvent = function (e) {\n  angular.isFunction(e.preventDefault) && e.preventDefault();\n  angular.isFunction(e.stopPropagation) && e.stopPropagation();\n};\n\nconst getBlockNodes = function (nodes) {\n  var node = nodes[0];\n  var endNode = nodes[nodes.length - 1];\n  var blockNodes;\n\n  for (var i = 1; node !== endNode && (node = node.nextSibling); i++) {\n    if (blockNodes || nodes[i] !== node) {\n      if (!blockNodes) {\n        blockNodes = jqLite(slice.call(nodes, 0, i));\n      }\n      blockNodes.push(node);\n    }\n  }\n\n  return blockNodes || nodes;\n};\n\nconst renderDOM = (ops)=> {\n  if (!ops.childScope) {\n    ops.$transclude(function (clone, newScope) {\n      ops.childScope = newScope;\n      clone[clone.length++] = ops.$window.document.createComment(' end ' + ops.directive + ': ' + ops.$attr[ops.directive] + ' ');\n      ops.block = {\n        clone: clone\n      };\n      ops.$animate.enter(clone, ops.$element.parent(), ops.$element);\n    });\n  }\n};\n\nconst removeDOM = (ops)=> {\n  if (ops.previousElements) {\n    ops.previousElements.remove();\n    ops.previousElements = null;\n  }\n  if (ops.childScope) {\n    ops.childScope.$destroy();\n    ops.childScope = null;\n  }\n  if (ops.block) {\n    ops.previousElements = getBlockNodes(ops.block.clone);\n    ops.$animate.leave(ops.previousElements).then(function () {\n      ops.previousElements = null;\n    });\n    ops.block = null;\n  }\n};\n\nexport {isPromise, renderDOM, removeDOM, stopEvent};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/common.js\n ** module id = 3\n ** module chunks = 0\n **/","import {renderDOM, removeDOM, stopEvent} from './common';\n\nconst ngPending = ($animate, $window)=> {\n  return {\n    multiElement: true,\n    transclude: 'element',\n    priority: 999,\n    terminal: true,\n    restrict: 'A',\n    require: '^ngPromise',\n    link: function ($scope, $element, $attr, ctrl, $transclude) {\n      var ops = {\n        $scope,\n        $element,\n        $attr,\n        $transclude,\n        $animate,\n        $window,\n        block: null,\n        childScope: null,\n        previousElements: null,\n        directive: 'ngPending'\n      };\n      $scope.$on('ngPromise', (e, status) => {\n        let a = status === -1 ? renderDOM(ops) : removeDOM(ops);\n        stopEvent(e, a);\n      });\n\n    }\n  };\n};\n\nngPending.$inject = ['$animate', '$window'];\n\nexport default ngPending;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/ng-pending.js\n ** module id = 4\n ** module chunks = 0\n **/","import {renderDOM, removeDOM, stopEvent} from './common';\n\nlet ngResolve = ($animate, $window, $parse)=> {\n  return {\n    multiElement: true,\n    transclude: 'element',\n    priority: 999,\n    terminal: true,\n    restrict: 'A',\n    require: '^ngPromise',\n    link($scope, $element, $attr, ctrl, $transclude) {\n      var ops = {\n        $scope,\n        $element,\n        $attr,\n        ctrl,\n        $transclude,\n        $animate,\n        $window,\n        $parse,\n        block: null,\n        childScope: null,\n        previousElements: null,\n        directive: 'ngResolve',\n        watcher: null\n      };\n      $scope.$on('ngPromise', (e, status) => {\n        let a = status === 1 ? renderDOM(ops) : removeDOM(ops);\n        stopEvent(e, a);\n      });\n    }\n  };\n};\n\nngResolve.$inject = ['$animate', '$window', '$parse'];\n\nexport default ngResolve;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/ng-resolve.js\n ** module id = 5\n ** module chunks = 0\n **/","import {renderDOM, removeDOM, stopEvent} from './common';\n\nconst ngReject = ($animate, $window)=> {\n  return {\n    multiElement: true,\n    transclude: 'element',\n    priority: 999,\n    terminal: true,\n    restrict: 'A',\n    require: '^ngPromise',\n    link($scope, $element, $attr, ctrl, $transclude) {\n\n      var ops = {\n        $scope,\n        $element,\n        $attr,\n        $transclude,\n        $animate,\n        $window,\n        block: null,\n        childScope: null,\n        previousElements: null,\n        directive: 'ngReject'\n      };\n\n      $scope.$on('ngPromise', (e, status) => {\n        let a = status === 0 ? renderDOM(ops) : removeDOM(ops);\n        stopEvent(e, a);\n      });\n\n    }\n  };\n};\n\nngReject.$inject = ['$animate', '$window'];\n\nexport default ngReject;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/ng-reject.js\n ** module id = 6\n ** module chunks = 0\n **/","import {renderDOM, removeDOM, stopEvent} from './common';\n\nconst ngFinally = ($animate, $window)=> {\n  return {\n    multiElement: true,\n    transclude: 'element',\n    priority: 999,\n    terminal: true,\n    restrict: 'A',\n    require: '^ngPromise',\n    link: function ($scope, $element, $attr, ctrl, $transclude) {\n      var ops = {\n        $scope,\n        $element,\n        $attr: $attr,\n        $transclude,\n        $animate,\n        $window,\n        block: null,\n        childScope: null,\n        previousElements: null,\n        directive: 'ngFinally'\n      };\n      $scope.$on('ngPromise', (e, status) => {\n        let a = status !== -1 ? renderDOM(ops) : removeDOM(ops);\n        stopEvent(e, a);\n      });\n    }\n  };\n};\n\nngFinally.$inject = ['$animate', '$window'];\n\nexport default ngFinally;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/ng-finally.js\n ** module id = 7\n ** module chunks = 0\n **/"],"sourceRoot":""}